{"version":3,"file":"menu.service.js","sourceRoot":"","sources":["../../../../../.ng_build/theme/components/menu/menu.service.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nimport { Injectable } from '@angular/core';\nimport { Location } from '@angular/common';\nimport { Params } from '@angular/router';\nimport { Observable, BehaviorSubject, ReplaySubject, Subject } from 'rxjs';\nimport { share } from 'rxjs/operators';\nimport { isUrlPathContain, isUrlPathEqual } from './url-matching-helpers';\n\nexport interface NbMenuBag { tag: string; item: NbMenuItem }\n\nconst itemClick$ = new Subject<NbMenuBag>();\nconst addItems$ = new ReplaySubject<{ tag: string; items: NbMenuItem[] }>(1);\nconst navigateHome$ = new ReplaySubject<{ tag: string }>(1);\nconst getSelectedItem$\n  = new ReplaySubject<{ tag: string; listener: BehaviorSubject<NbMenuBag> }>(1);\nconst itemSelect$ = new ReplaySubject<NbMenuBag>(1);\nconst itemHover$ = new ReplaySubject<NbMenuBag>(1);\nconst submenuToggle$ = new ReplaySubject<NbMenuBag>(1);\nconst collapseAll$ = new ReplaySubject<{ tag: string }>(1);\n\n// TODO: check if we need both URL and LINK\n/**\n *\n *\n * Menu Item options example\n * @stacked-example(Menu Link Parameters, menu/menu-link-params.component)\n *\n *\n */\nexport class NbMenuItem {\n  /**\n   * Item Title\n   * @type {string}\n   */\n  title: string;\n  /**\n   * Item relative link (for routerLink)\n   * @type {string}\n   */\n  link?: string;\n  /**\n   * Item URL (absolute)\n   * @type {string}\n   */\n  url?: string;\n  /**\n   * Icon class name\n   * @type {string}\n   */\n  icon?: string;\n  /**\n   * Expanded by default\n   * @type {boolean}\n   */\n  expanded?: boolean;\n  /**\n   * Children items\n   * @type {List<NbMenuItem>}\n   */\n  children?: NbMenuItem[];\n  /**\n   * HTML Link target\n   * @type {string}\n   */\n  target?: string;\n  /**\n   * Hidden Item\n   * @type {boolean}\n   */\n  hidden?: boolean;\n  /**\n   * Item is selected when partly or fully equal to the current url\n   * @type {string}\n   */\n  pathMatch?: string = 'full';\n  /**\n   * Where this is a home item\n   * @type {boolean}\n   */\n  home?: boolean;\n  /**\n   * Whether the item is just a group (non-clickable)\n   * @type {boolean}\n   */\n  group?: boolean;\n  /** Whether the item skipLocationChange is true or false\n   *@type {boolean}\n   */\n  skipLocationChange?: boolean;\n  /** Map of query parameters\n   *@type {Params}\n   */\n  queryParams?: Params;\n  parent?: NbMenuItem;\n  selected?: boolean;\n  data?: any;\n  fragment?: string;\n\n  /**\n   * @returns item parents in top-down order\n   */\n  static getParents(item: NbMenuItem): NbMenuItem[] {\n    const parents = [];\n\n    let parent = item.parent;\n    while (parent) {\n      parents.unshift(parent);\n      parent = parent.parent;\n    }\n\n    return parents;\n  }\n\n  static isParent(item: NbMenuItem, possibleChild: NbMenuItem): boolean {\n    return possibleChild.parent\n      ? possibleChild.parent === item || this.isParent(item, possibleChild.parent)\n      : false;\n  }\n}\n\n// TODO: map select events to router change events\n// TODO: review the interface\n/**\n *\n *\n * Menu Service. Allows you to listen to menu events, or to interact with a menu.\n * @stacked-example(Menu Service, menu/menu-service.component)\n *\n *\n */\n@Injectable()\nexport class NbMenuService {\n\n  /**\n   * Add items to the end of the menu items list\n   * @param {List<NbMenuItem>} items\n   * @param {string} tag\n   */\n  addItems(items: NbMenuItem[], tag?: string) {\n    addItems$.next({ tag, items });\n  }\n\n  /**\n   * Collapses all menu items\n   * @param {string} tag\n   */\n  collapseAll(tag?: string) {\n    collapseAll$.next({ tag });\n  }\n\n  /**\n   * Navigate to the home menu item\n   * @param {string} tag\n   */\n  navigateHome(tag?: string) {\n    navigateHome$.next({ tag });\n  }\n\n  /**\n   * Returns currently selected item. Won't subscribe to the future events.\n   * @param {string} tag\n   * @returns {Observable<{tag: string; item: NbMenuItem}>}\n   */\n  getSelectedItem(tag?: string): Observable<NbMenuBag> {\n    const listener = new BehaviorSubject<NbMenuBag>(null);\n\n    getSelectedItem$.next({ tag, listener });\n\n    return listener.asObservable();\n  }\n\n  onItemClick(): Observable<NbMenuBag> {\n    return itemClick$.pipe(share());\n  }\n\n  onItemSelect(): Observable<NbMenuBag> {\n    return itemSelect$.pipe(share());\n  }\n\n  onItemHover(): Observable<NbMenuBag> {\n    return itemHover$.pipe(share());\n  }\n\n  onSubmenuToggle(): Observable<NbMenuBag> {\n    return submenuToggle$.pipe(share());\n  }\n}\n\n@Injectable()\nexport class NbMenuInternalService {\n\n  constructor(private location: Location) {}\n\n  prepareItems(items: NbMenuItem[]) {\n    const defaultItem = new NbMenuItem();\n    items.forEach(i => {\n      this.applyDefaults(i, defaultItem);\n      this.setParent(i);\n    });\n  }\n\n  selectFromUrl(items: NbMenuItem[], tag: string, collapseOther: boolean = false) {\n    const selectedItem = this.findItemByUrl(items);\n    if (selectedItem) {\n      this.selectItem(selectedItem, items, collapseOther, tag);\n    }\n  }\n\n  selectItem(item: NbMenuItem, items: NbMenuItem[], collapseOther: boolean = false, tag: string) {\n    const unselectedItems = this.resetSelection(items);\n    const collapsedItems = collapseOther ? this.collapseItems(items) : [];\n\n    for (const parent of NbMenuItem.getParents(item)) {\n      parent.selected = true;\n      // emit event only for items that weren't selected before ('unselectedItems' contains items that were selected)\n      if (!unselectedItems.includes(parent)) {\n        this.itemSelect(parent, tag);\n      }\n\n      const wasNotExpanded = !parent.expanded;\n      parent.expanded = true;\n      const i = collapsedItems.indexOf(parent);\n      // emit event only for items that weren't expanded before.\n      // 'collapsedItems' contains items that were expanded, so no need to emit event.\n      // in case 'collapseOther' is false, 'collapsedItems' will be empty,\n      // so also check if item isn't expanded already ('wasNotExpanded').\n      if (i === -1 && wasNotExpanded) {\n        this.submenuToggle(parent, tag);\n      } else {\n        collapsedItems.splice(i, 1);\n      }\n    }\n\n    item.selected = true;\n    // emit event only for items that weren't selected before ('unselectedItems' contains items that were selected)\n    if (!unselectedItems.includes(item)) {\n      this.itemSelect(item, tag);\n    }\n\n    // remaining items which wasn't expanded back after expanding all currently selected items\n    for (const collapsedItem of collapsedItems) {\n      this.submenuToggle(collapsedItem, tag);\n    }\n  }\n\n  collapseAll(items: NbMenuItem[], tag: string, except?: NbMenuItem) {\n    const collapsedItems = this.collapseItems(items, except);\n\n    for (const item of collapsedItems) {\n      this.submenuToggle(item, tag);\n    }\n  }\n\n  onAddItem(): Observable<{ tag: string; items: NbMenuItem[] }> {\n    return addItems$.pipe(share());\n  }\n\n  onNavigateHome(): Observable<{ tag: string }> {\n    return navigateHome$.pipe(share());\n  }\n\n  onCollapseAll(): Observable<{ tag: string }> {\n    return collapseAll$.pipe(share());\n  }\n\n  onGetSelectedItem(): Observable<{ tag: string; listener: BehaviorSubject<NbMenuBag> }> {\n    return getSelectedItem$.pipe(share());\n  }\n\n  itemHover(item: NbMenuItem, tag?: string) {\n    itemHover$.next({tag, item});\n  }\n\n  submenuToggle(item: NbMenuItem, tag?: string) {\n    submenuToggle$.next({tag, item});\n  }\n\n  itemSelect(item: NbMenuItem, tag?: string) {\n    itemSelect$.next({tag, item});\n  }\n\n  itemClick(item: NbMenuItem, tag?: string) {\n    itemClick$.next({tag, item});\n  }\n\n  /**\n   * Unselect all given items deeply.\n   * @param items array of items to unselect.\n   * @returns items which selected value was changed.\n   */\n  private resetSelection(items: NbMenuItem[]): NbMenuItem[] {\n    const unselectedItems = [];\n\n    for (const item of items) {\n      if (item.selected) {\n        unselectedItems.push(item);\n      }\n      item.selected = false;\n\n      if (item.children) {\n        unselectedItems.push(...this.resetSelection(item.children));\n      }\n    }\n\n    return unselectedItems;\n  }\n\n  /**\n   * Collapse all given items deeply.\n   * @param items array of items to collapse.\n   * @param except menu item which shouldn't be collapsed, also disables collapsing for parents of this item.\n   * @returns items which expanded value was changed.\n   */\n  private collapseItems(items: NbMenuItem[], except?: NbMenuItem): NbMenuItem[] {\n    const collapsedItems = [];\n\n    for (const item of items) {\n      if (except && (item === except || NbMenuItem.isParent(item, except))) {\n        continue;\n      }\n\n      if (item.expanded) {\n        collapsedItems.push(item)\n      }\n      item.expanded = false;\n\n      if (item.children) {\n        collapsedItems.push(...this.collapseItems(item.children));\n      }\n    }\n\n    return collapsedItems;\n  }\n\n  private applyDefaults(item, defaultItem) {\n    const menuItem = {...item};\n    Object.assign(item, defaultItem, menuItem);\n    item.children && item.children.forEach(child => {\n      this.applyDefaults(child, defaultItem);\n    });\n  }\n\n  private setParent(item: NbMenuItem) {\n    item.children && item.children.forEach(child => {\n      child.parent = item;\n      this.setParent(child);\n    });\n  }\n\n  /**\n   * Find deepest item which link matches current URL path.\n   * @param items array of items to search in.\n   * @returns found item of undefined.\n   */\n  private findItemByUrl(items: NbMenuItem[]): NbMenuItem | undefined {\n    let selectedItem;\n\n    items.some(item => {\n      if (item.children) {\n        selectedItem = this.findItemByUrl(item.children);\n      }\n      if (!selectedItem && this.isSelectedInUrl(item)) {\n        selectedItem = item;\n      }\n\n      return selectedItem;\n    });\n\n    return selectedItem;\n  }\n\n  private isSelectedInUrl(item: NbMenuItem): boolean {\n    const exact: boolean = item.pathMatch === 'full';\n    return exact\n      ? isUrlPathEqual(this.location.path(), item.link)\n      : isUrlPathContain(this.location.path(), item.link);\n  }\n}\n"]}